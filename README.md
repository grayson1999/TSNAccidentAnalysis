# TSN과 YOLO를 활용한 교통사고 영상 분석 및 예측 모델

> 본 프로젝트는 딥러닝 영상 인식 프레임워크인 mmaction2를 기반으로, 교통사고 영상의 패턴을 분석하고 사고 유형을 예측하는 모델을 개발하는 것을 목표로 합니다. 특히, Temporal Segment Network(TSN) 모델을 핵심으로 사용하며, YOLOv8 객체 탐지 모델과의 연동 및 Optuna를 이용한 하이퍼파라미터 최적화를 통해 성능을 개선했습니다.

---

##  목차

1.  [프로젝트 개요](#1-프로젝트-개요)
2.  [나의 역할 및 기여](#2-나의-역할-및-기여)
3.  [사용 기술 스택](#3-사용-기술-스택)
4.  [구현 및 결과](#4-구현-및-결과)
    - [모델 아키텍처](#41-모델-아키텍처)
    - [성능 평가](#42-성능-평가)
5.  [배운 점 및 차별화 포인트](#5-배운-점-및-차별화-포인트)

---

## 1. 프로젝트 개요

교통사고 영상은 복잡하고 동적인 정보를 담고 있어 정확한 상황 인식이 어렵습니다. 이 프로젝트는 TSN 모델을 활용하여 영상의 시간적 특징을 효과적으로 학습하고, 사고 유형을 분류하는 딥러닝 모델을 개발합니다. 또한, YOLOv8 모델을 전처리 단계에 통합하여 영상 내 주요 객체(차량 등)에 집중함으로써 모델의 인식 정확도를 높이는 2-stage 접근법을 실험하고, Optuna를 통해 최적의 학습 조건을 탐색하여 모델의 성능을 최종적으로 검증합니다.

## 2. 나의 역할 및 기여

본 프로젝트에서 다음과 같은 핵심적인 역할을 수행했습니다.

-   **TSN 모델 커스터마이징 및 학습 파이프라인 구축**: `mmaction2` 프레임워크를 활용하여 교통사고 데이터셋에 맞는 TSN 모델의 학습, 검증, 테스트 파이프라인(`train.py`, `test.py`)을 처음부터 구축했습니다.
-   **YOLOv8 기반 2-Stage 모델 설계**: 영상 전체가 아닌, 사고와 직접적으로 관련된 객체에 모델이 집중할 수 있도록 YOLOv8로 객체를 탐지하고 해당 영역을 Crop하여 TSN 모델에 입력하는 2-Stage 아키텍처(`yolo_tsn_model`)를 설계하고 구현했습니다.
-   **Optuna를 이용한 하이퍼파라미터 최적화**: `Optuna` 라이브러리를 도입하여 학습률(learning rate), 옵티마이저(optimizer) 등 주요 하이퍼파라미터를 자동적이고 체계적으로 튜닝하는 프로세스(`otuna_train.py`)를 구현하여 모델의 잠재 성능을 극대화했습니다.
-   **성과 중심의 실험 설계 및 분석**: Top-1/Top-5 정확도, 코사인 유사도 등 다양한 평가지표를 설정하고, 모델 버전별 성능을 체계적으로 비교 분석하여 각 요소 기술의 기여도를 정량적으로 평가하고 최적의 모델을 선정했습니다.

## 3. 사용 기술 스택

-   **Frameworks & Libraries**: `PyTorch`, `mmaction2`, `MMCV`, `ultralytics (YOLOv8)`, `Optuna`
-   **Data Handling**: `Pandas`, `NumPy`
-   **Visualization**: `Seaborn`, `Matplotlib`
-   **Language**: `Python`
-   **DevOps**: `Git`

## 4. 구현 및 결과

### 4.1. 모델 아키텍처

본 프로젝트에서는 두 가지 주요 모델 아키텍처를 실험하고 비교했습니다.

1.  **Single TSN Model**: 원본 영상을 직접 TSN 모델에 입력하여 영상 전체의 시간적 특징을 학습하는 기본 모델입니다.
2.  **YOLO-TSN Model**: YOLOv8이 영상에서 주요 객체(차량 등)를 먼저 탐지하고, 해당 객체의 Bounding Box를 기준으로 이미지를 Crop합니다. 이후 Crop된 이미지 시퀀스를 TSN 모델의 입력으로 사용하여, 불필요한 배경 정보를 제거하고 핵심 정보에 집중하도록 설계된 2-Stage 모델입니다.

### 4.2. 성능 평가

다양한 조건에서 학습된 모델들의 성능을 종합적으로 평가한 결과는 다음과 같습니다.

| 모델 (Model)                          | Top-1 Acc. (%) | Top-5 Acc. (%) | Rate Acc. (%) | ±10% Error Rate Acc. (%) | 평균 코사인 유사도 |
| ------------------------------------- | :------------: | :------------: | :-----------: | :----------------------: | :----------------: |
| `single_tsn_model` (best_model_0522)  |      20.6      |      29.9      |       ·       |            ·             |         ·          |
| `single_tsn_model` (best_model_0527)  |      23.0      |      46.8      |     32.0      |            ·             |         ·          |
| `yolo_tsn_model` (best_model_0527)    |      22.1      |      47.2      |     31.8      |            ·             |         ·          |
| **`single_tsn_model` (best_model_0529)** |   **24.67**    |   **48.90**    |   **33.50**   |        **46.83**         |     **81.54**      |
| `yolo_tsn_model` (best_model_0529)    |     23.50      |     49.48      |     33.43     |          47.38           |       81.58        |
| `single_tsn_model` (best_model_0531)  |     21.50      |     45.36      |     30.63     |          44.92           |         ·          |

-   **최고 성능**: `best_model_0529` 버전의 **`single_tsn_model`** 이 Top-1 정확도(24.67%)를 포함한 대부분의 지표에서 가장 우수한 성능을 기록했습니다.
-   **YOLO 연동 효과**: YOLO를 연동한 모델(`yolo_tsn_model`)은 Top-1 정확도는 소폭 하락했지만, Top-5 정확도와 코사인 유사도에서는 근소한 성능 향상을 보여주었습니다. 이는 모델이 핵심 객체에 집중하여 더 안정적인 예측을 생성할 가능성을 시사합니다.

## 5. 배운 점 및 차별화 포인트

-   **프레임워크 활용 능력**: `mmaction2`와 같은 대규모 딥러닝 프레임워크의 구조를 이해하고, 특정 도메인(교통사고)에 맞게 커스터마이징하여 실제 문제를 해결하는 능력을 길렀습니다.
-   **체계적인 성능 최적화**: 단순히 감에 의존하는 것이 아니라, `Optuna`와 같은 자동화된 튜닝 라이브러리를 활용하여 데이터 기반의 체계적인 하이퍼파라미터 최적화를 수행하고 성능을 개선한 경험을 쌓았습니다.
-   **가설 기반 모델 설계 및 검증**: '객체에 집중하면 성능이 오를 것이다'라는 가설을 바탕으로 YOLO-TSN 2-Stage 모델을 직접 설계하고, 실험을 통해 가설을 정량적으로 검증하며 모델 아키텍처 설계 능력을 향상시켰습니다.
-   **종합적인 결과 분석**: 단일 지표(예: Top-1 정확도)에 매몰되지 않고, 코사인 유사도 등 다양한 관점의 평가지표를 도입하여 모델의 성능을 다각적으로 해석하고 종합적인 결론을 도출하는 분석 능력을 갖추게 되었습니다.
